<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UDI</title>

<!-- Font Special Elite -->
<link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    padding: 0;
    font-family: 'Special Elite', monospace;
    background: url('background.png') no-repeat center center fixed;
    background-size: cover;
    color: white;
}

/* GIF trên cùng */
.gif-top {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%, -50%);
    width: 200px;
    height: auto;
    pointer-events: none;
    z-index: 1;
}

/* PASSWORD SCREEN */
#password-screen {
    position: center;
    top: 0; left: 0;
    width: 100%; height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;
}

#password-screen input,
#password-screen button {
    background: transparent;
    border: none;
    border-bottom: none rgba(255,255,255,0.5);
    margin: 10px 0;
    font-size: 20px;
    color: white;
    outline: none;
    text-align: center;
    font-family: 'Special Elite', monospace;
    width: 250px;
}

#password-screen input::placeholder {
    color: rgba(255,255,255,0.5);
}

/* MAIN FORM */
#main-content {
    display: none;
    text-align: center;
    padding-top: 100px;
    position: relative;
    z-index: 5;
}

#main-content h2 {
    margin-bottom: 20px;
    color: white;
}

#main-content input {
    background: transparent;
    border: none;
    border-bottom: none rgba(255,255,255,0.5);
    margin: 10px 0;
    padding: 5px 0;
    font-size: 18px;
    color: white;
    outline: none;
    text-align: left;
    font-family: 'Special Elite', monospace;
    width: 400px;      /* đủ dài cho wallet */
    max-width: 90%;
}

/* Row chứa wallet + submit */
.form-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
    width: 400px;
    max-width: 90%;
}

#walletInput {
    flex: 1;
    margin-right: 10px;
    font-family: 'Special Elite', monospace;
}

#submitBtn {
    padding: none;
    cursor: pointer;
    font-family: 'Special Elite', monospace;
}

/* Placeholder mờ */
#main-content input::placeholder {
    color: rgba(255,255,255,0.5);
}

#success-text {
    margin-top: 15px;
    color: #00ffea;
    font-size: 18px;
    display: none;
}
</style>
</head>

<body>

<!-- PASSWORD SCREEN -->
<div id="password-screen">
    <img src="IMG_1930.gif" class="gif-top" alt="Password GIF">
    <input type="password" id="passInput" placeholder="Enter Password">
    <button onclick="checkPass()">Enter</button>
</div>

<!-- MAIN FORM -->
<div id="main-content">
    <img src="IMG_1930.gif" class="gif-top" alt="Form GIF">
    <h2>Whitelist Form</h2>
    
    <form id="whitelistForm" action="https://sheetdb.io/api/v1/YOUR_SHEET_ENDPOINT" method="POST">
        <!-- X Profile -->
        <input type="text" id="xInput" name="data[x]" placeholder="@X Profile" required>

        <!-- Wallet + Submit ngang hàng -->
        <div class="form-row">
            <input type="text" id="walletInput" name="data[wallet]" placeholder="0xETH Wallet" required>
            <button type="submit" id="submitBtn">Submit</button>
        </div>
    </form>

    <div id="success-text">Success, welcome UDIverse — good luck!</div>
</div>

<script>
/* PASSWORD CHECK */
function checkPass() {
    const correctPass = "udi2025";
    const input = document.getElementById("passInput").value;

    if (input === correctPass) {
        document.getElementById("password-screen").style.display = "none";
        document.getElementById("main-content").style.display = "block";
    } else {
        alert("Wrong password!");
    }
}

/* FORM VALIDATION & ANTI-SPAM */
let failCount = 0;
const maxFails = 3;
const lockTime = 10000;

document.getElementById("whitelistForm").addEventListener("submit", function(e){
    e.preventDefault();

    const xInput = document.getElementById("xInput").value.trim();
    const walletInput = document.getElementById("walletInput").value.trim();
    const submitBtn = document.getElementById("submitBtn");

    if (!xInput.startsWith("@")) {
        alert("X profile must start with @");
        failCount++;
        checkLock();
        return;
    }

    const ethRegex = /^0x[a-fA-F0-9]{40}$/;
    if (!ethRegex.test(walletInput)) {
        alert("Invalid ETH wallet address");
        failCount++;
        checkLock();
        return;
    }

    const form = this;
    fetch(form.action, {
        method: "POST",
        body: new FormData(form)
    })
    .then(() => {
        document.getElementById("success-text").style.display = "block";
        form.reset();
        failCount = 0;
    })
    .catch(err => {
        alert("Error submitting form");
        console.error(err);
    });
});

function checkLock() {
    const submitBtn = document.getElementById("submitBtn");
    if (failCount >= maxFails) {
        submitBtn.disabled = true;
        alert(`Too many failed attempts! Please wait ${lockTime/1000} seconds.`);
        setTimeout(() => {
            failCount = 0;
            submitBtn.disabled = false;
        }, lockTime);
    }
}
</script>

</body>
</html>